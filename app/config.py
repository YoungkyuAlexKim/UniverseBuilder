"""
설정 값들을 중앙에서 관리하는 모듈
"""
from typing import List
from dataclasses import dataclass, field


@dataclass
class AIModels:
    """AI 모델 관련 설정"""
    available: List[str] = field(default_factory=lambda: [
        "gemini-2.5-flash-lite",
        "gemini-2.5-flash"
    ])
    default: str = "gemini-2.5-flash-lite"


@dataclass
class AIPrompts:
    """AI 프롬프트 템플릿"""
    worldview_new: str = """당신은 무한한 상상력으로 독자들이 살고 싶어하는 매혹적인 세계를 창조하는 세계 건축의 거장입니다.
한 문장만 들어도 그 세계가 눈앞에 펼쳐지고, 독자가 그곳에서 모험을 떠나고 싶게 만드는 생생하고 신비로운 세계를 창조하는 마법사입니다.

사용자가 제공한 '핵심 키워드'에서 영감을 받아, 독자의 마음을 완전히 사로잡을 독창적이고 매혹적인 가상 세계의 기초를 창조해주세요.
**매우 중요한 규칙:**
1.  결과는 반드시 '출력 항목 예시'에 명시된 5가지 항목(세계의 이름과 분위기, 핵심 설정, 주요 역사, 지배 세력, 주요 갈등)을 모두 포함해야 합니다.
2.  다른 어떤 설명도 추가하지 말고, 생성된 세계관 설정 텍스트 본문만 응답해야 합니다.
---
[핵심 키워드]
"{keywords}"
---
[출력]
(당신이 창조한 새로운 세계관 설정)
"""

    worldview_edit: str = """당신은 기존의 세계를 더욱 풍성하고 매혹적으로 발전시키는 세계 진화의 대가입니다.
평범한 세계관을 독자가 손에 땀을 쥐고 탐험하고 싶어하는 신비롭고 생생한 세계로 승화시키는 세계관 연금술사입니다.

아래에 제공된 '기존 세계관 설정'의 핵심 영혼을 보존하면서, 사용자의 '요청사항'을 통해 그 세계를 더욱 깊이 있고 매력적으로 진화시켜 주세요.
**매우 중요한 규칙:**
1.  **'기존 세계관 설정'의 구조, 문체, 핵심 용어 등을 반드시 유지해야 합니다.**
2.  사용자의 '요청사항'은 기존 설정에 자연스럽게 녹아들도록 추가하거나, 기존 내용의 일부를 논리적으로 수정하는 방식으로 반영해야 합니다.
3.  최종 결과물은 **완성된 전체 세계관 텍스트**여야 합니다. 추가된 부분만 응답해서는 안 됩니다.
---
[기존 세계관 설정]
{existing_content}
---
[사용자 요청사항]
"{keywords}"
---
[출력]
(수정/확장된 전체 세계관 텍스트)
"""

    character_generation: str = """당신은 독자의 마음에 깊이 각인되는 매혹적인 캐릭터들을 창조하는 베테랑 소설가입니다.
한 번 등장하면 잊을 수 없는 강렬한 인상을 남기고, 독자가 그들의 운명을 끝까지 지켜보고 싶게 만드는 생생한 인물을 창조하는 전문가입니다.
아래 창작 재료들을 바탕으로, 이 세계에서 숨 쉬고 살아가는 듯한 입체적이고 매력적인 새로운 캐릭터를 탄생시켜 주세요.

**🎭 창작 재료**
{worldview_context}
{worldview_cards_context}
{character_context}

**🎯 사용자 요청:** {keywords}

**✨ 캐릭터 창조의 5가지 핵심 원칙:**
1. **생생한 개성**: 단순한 설명이 아닌, 독자가 실제로 만날 수 있을 것 같은 구체적이고 독특한 개성을 부여하세요
2. **감정의 깊이**: 표면적 설정을 넘어, 캐릭터의 내면 갈등과 복잡한 감정을 드러내는 배경을 만드세요  
3. **매력적인 모순**: 완벽하지 않은, 인간적인 약점과 장점이 공존하는 입체적 캐릭터를 만드세요
4. **강렬한 존재감**: 등장만으로도 분위기를 바꾸고, 다른 캐릭터들과 화학적 반응을 일으킬 수 있는 카리스마를 부여하세요
5. **미래의 가능성**: 성장하고 변화할 여지가 있는, 스토리 전개에 능동적으로 참여할 수 있는 동적 캐릭터를 만드세요

**📝 세부 창작 가이드:**
- **이름**: 캐릭터의 본질과 세계관에 어울리는 인상적인 이름
- **설명**: 외모뿐만 아니라 말투, 습관, 분위기까지 느껴지는 생생한 묘사
- **목표**: 절박하고 구체적인 욕망, 독자가 공감하거나 이해할 수 있는 동기
- **성격**: 단순한 키워드가 아닌, 행동으로 드러나는 구체적 특성들
- **능력**: 스토리에 도움이 되면서도 캐릭터의 개성을 반영하는 독창적 재능
- **대사**: 캐릭터의 철학과 개성이 드러나는 인상적이고 기억에 남을 말들
- **등장 서사**: 첫 등장부터 독자를 사로잡을 극적이고 상징적인 순간

**🎨 스타일 지침:**
- 생동감 있고 감각적인 표현 사용
- 캐릭터만의 독특한 말투와 행동 패턴 반영
- 독자의 상상력을 자극하는 구체적이고 인상적인 디테일
- 다른 캐릭터들과 차별화되는 독창적 요소

**매우 중요한 규칙:**
1.  **HTML 태그는 절대 사용하지 말고, 순수한 텍스트로만 응답해야 합니다.**
2.  결과는 반드시 아래 명시된 JSON 스키마를 따르는 JSON 객체로만 응답해야 합니다. 다른 어떤 텍스트도 포함하지 마세요.
**출력 JSON 스키마:**
{{
  "name": "캐릭터 이름",
  "description": "캐릭터의 외모, 성격, 배경 이야기 (순수 텍스트).",
  "goal": ["캐릭터의 목표 또는 동기 1", "캐릭터의 목표 또는 동기 2"],
  "personality": ["성격 키워드 1", "성격 키워드 2"],
  "abilities": ["보유 기술 또는 능력 1", "보유 기술 또는 능력 2"],
  "quote": ["캐릭터를 대표하는 대사 1", "캐릭터를 대표하는 대사 2", "캐릭터를 대표하는 대사 3", "캐릭터를 대표하는 대사 4", "캐릭터를 대표하는 대사 5"],
  "introduction_story": "등장 서사 (순수 텍스트)."
}}
"""

    character_edit: str = """당신은 평범한 캐릭터를 독자가 사랑하고 기억할 수밖에 없는 매혹적인 인물로 변화시키는 캐릭터 진화의 마에스트로입니다.
기존 캐릭터의 본질과 영혼을 깊이 이해하고, 사용자의 요청을 통해 그들을 더욱 생생하고 입체적이며 매력적인 인물로 승화시키는 캐릭터 연금술사입니다.

아래에 제공되는 '프로젝트 데이터'와 '사용자 요청사항'을 바탕으로, 캐릭터의 핵심 개성은 유지하면서도 더욱 깊이 있고 흥미로운 인물로 발전시켜 주세요.
**매우 중요한 규칙:**
1.  **HTML 태그는 절대 사용하지 말고, 순수한 텍스트로만 응답해야 합니다.**
2.  {editing_instruction}
3.  'quote', 'personality', 'abilities', 'goal' 항목은 반드시 **배열(리스트)** 형태로 반환해야 합니다.
4.  절대로 기존 카드의 'id'는 변경해서는 안 됩니다.
5.  최종 결과는 반드시 아래 명시된 JSON 형식으로만 반환해야 합니다.
---
[프로젝트 데이터 (사용자가 선택한 일부)]
{full_project_context}
---
[사용자 요청사항]
"{prompt_text}"
---
[출력 JSON 형식]
{{
  "updated_cards": [
    {{
      "id": "수정된 카드의 id",
      "name": "새로운 이름 (변경 시)",
      "description": "새로운 설명 (순수 텍스트)",
      "goal": ["새로운 목표 1"],
      "personality": ["새로운 성격 키워드 1"],
      "abilities": ["새로운 기술 또는 능력 1"],
      "quote": ["새로운 대사 1"],
      "introduction_story": "새로운 서사 (순수 텍스트)"
    }}
  ]
}}
"""

    worldview_card_edit: str = """당신은 세계관 설정의 일관성을 유지하는 전문 편집자입니다.
아래 정보를 바탕으로 **세계관 설정 카드**의 내용을 수정해주세요.
**매우 중요한 규칙:**
1.  {editing_instruction}
2.  절대로 기존 카드의 'id'는 변경해서는 안 됩니다.
3.  최종 결과는 반드시 아래 명시된 JSON 형식으로만 반환해야 합니다.
---
[메인 세계관 정보]
{main_worldview_context}
---
[관련 설정 카드 정보 (JSON)]
{worldview_cards_json}
---
[사용자 요청사항]
"{prompt_text}"
---
[출력 JSON 형식]
{{
  "updated_cards": [
    {{
      "id": "수정된 카드의 id",
      "title": "새로운 제목 (변경 시)",
      "content": "새로운 내용 (순수 텍스트)"
    }}
  ]
}}
"""

    scenario_draft: str = """[SYSTEM INSTRUCTION]
당신은 '기승전결' 4막 구조에 능통한 전문 스토리 작가입니다.
주어진 [CONTEXT]를 바탕으로, [TASK]에 명시된 규칙을 완벽하게 준수하여 흥미로운 플롯 아웃라인을 JSON 형식으로 생성해야 합니다.

[CONTEXT]
{worldview_rules_context}
{story_genre_context}
{scenario_themes}
{characters_context}
{story_concept}
{prologue_context}
---

[TASK]
1. [CONTEXT]의 모든 정보를 종합하여, 동양의 고전적인 **'기승전결' 4막 구조**를 따르는 플롯 아웃라인을 생성하세요.
2. 플롯은 정확히 {plot_point_count}개의 포인트로 구성되어야 합니다. 각 막의 비율은 대략 기(25%), 승(50%), 전(15%), 결(10%)을 따르도록 안배하세요.
3. **'전(轉)'** 파트에서는 이야기의 흐름을 뒤바꾸는 예상치 못한 반전이나 새로운 사건을 반드시 포함해야 합니다.
4. 최종 결과물은 반드시 아래 JSON 스키마를 따르는 단 하나의 JSON 객체여야 합니다. 다른 설명은 절대 포함하지 마세요.

**JSON 스키마:**
{{
  "plot_points": [
    {{
      "title": "플롯 포인트의 간결한 제목",
      "content": "이 플롯 포인트에서 발생하는 핵심 사건, 등장인물의 감정 변화, 그리고 다음 사건으로 이어지는 단서를 포함한 상세한 설명."
    }}
  ]
}}

---
[CRITICAL FINAL INSTRUCTION]
Your entire response must start with `{{` and end with `}}`. No other text, explanation, or formatting is permitted.
"""

    scenario_concept_refine: str = """당신은 아이디어의 본질을 꿰뚫어 보고, 그것을 독자의 가슴에 와닿는 매혹적인 이야기로 승화시키는 스토리 연금술사입니다.
평범한 컨셉을 읽는 순간 독자가 "이 이야기를 꼭 보고 싶다!"고 느끼게 만드는 강력하고 생생한 문장으로 변화시키는 마법사입니다.

아래 정보를 바탕으로, '기존 컨셉'의 핵심 영혼과 감성을 **완벽히 보존**하면서, 독자의 상상력을 자극하고 감정을 뒤흔드는 매력적인 컨셉으로 승화시켜 주세요.
{worldview_context}

**매우 중요한 규칙:**
1.  **세계관 일관성:** 다듬어진 문장은 반드시 '메인 세계관'의 설정과 충돌해서는 안 됩니다.
2.  **핵심 의도와 감성 유지:** 원본 문장이 가진 고유의 감성(예: 희망, 비극, 유머 등)과 핵심 의도를 변경해서는 안 됩니다. 문장을 확장하고 구체화하되, 완전히 다른 이야기로 바꾸지 마세요.
3.  추상적인 표현을 구체적인 상황이나 감정이 드러나도록 풍부하게 만들어 주세요.
4.  최종 결과는 **오직 다듬어진 한두 문장, 혹은 두세 문장의 컨셉 텍스트**여야 합니다. 다른 설명을 붙이지 마세요.

---
[기존 컨셉]
{existing_concept}
---
[출력]
(AI가 핵심 뉘앙스와 세계관을 유지하며 다듬은 새로운 컨셉)
"""

    worldview_rule_refine: str = """당신은 평범한 설정을 독자를 사로잡는 매혹적인 세계관으로 변화시키는 세계 구축의 마에스트로입니다.
한 문장만으로도 독자가 그 세계에 살고 싶고, 그 세계의 비밀을 알고 싶게 만드는 강력하고 신비로운 설정 문장을 창조하는 달인입니다.

아래 정보를 바탕으로, '기존 설정 문장'의 핵심 영혼과 의도를 **완벽히 보존**하면서, 독자가 상상의 나래를 펼시고 그 세계에 몰입할 수 있는 매력적인 설정으로 승화시켜 주세요.

{worldview_context}

**매우 중요한 규칙:**
1.  **일관성 유지:** 다듬어진 문장은 '메인 세계관 정보'와 충돌해서는 안 됩니다.
2.  **핵심 의도 유지:** 원본 문장이 가진 핵심 의미를 변경하지 마세요. 문장을 확장하고 구체화하되, 완전히 다른 내용으로 바꾸지 마세요.
3.  최종 결과는 **오직 다듬어진 한 문장의 텍스트**여야 합니다. 다른 설명을 붙이지 마세요.

---
[기존 설정 문장]
{existing_rule}
---
[출력]
(AI가 핵심 뉘앙스와 세계관을 유지하며 다듬은 새로운 문장)
"""

    relationship_suggestion: str = """당신은 인물 간의 복잡하고 매혹적인 관계를 창조하는 관계 설계의 달인입니다.
단순한 설정을 넘어서, 독자가 두 캐릭터의 상호작용을 보며 가슴 뛰고 몰입할 수 있는 깊이 있고 드라마틱한 관계를 창조하는 전문가입니다.

아래 캐릭터들의 내면과 본질을 깊이 이해하고, 그들 사이에서 피어날 수 있는 가장 흥미진진하고 감정적으로 풍부한 관계를 설계해주세요.

**🎭 관계 창조의 핵심 원칙:**
1. **감정적 화학반응**: 두 캐릭터가 만날 때 독자도 느낄 수 있는 전기 같은 긴장감이나 따뜻한 유대감을 만드세요
2. **복합적 감정**: 단순한 호감/적대가 아닌, 복잡하고 다층적인 감정들이 얽힌 입체적 관계를 설계하세요
3. **성장의 가능성**: 서로에게 영향을 주고받으며 변화하고 성장할 수 있는 동적 관계를 만드세요
4. **극적 긴장**: 갈등이든 협력이든, 스토리에 활력을 불어넣을 수 있는 드라마틱한 요소를 포함하세요
5. **인간적 진정성**: 독자가 공감하고 이해할 수 있는 현실적이면서도 매력적인 관계를 창조하세요
**매우 중요한 규칙:**
1.  결과는 반드시 아래 명시된 JSON 스키마를 따르는 JSON 객체로만 응답해야 합니다.
2.  'type'에는 관계를 한두 단어로 요약한 키워드를, 'description'에는 그 관계에 대한 2~3문장의 구체적인 설명을 작성해주세요.
3.  **생성되는 관계 설명은 반드시 '캐릭터 A'와 '캐릭터 B' 두 사람 사이의 직접적인 이야기에만 집중해야 합니다.**
4.  {final_instruction}
{existing_relationship_context}
---
[캐릭터 A 프로필 ({char_a_name})]
- 설명: {char_a_description}
- 목표: {char_a_goals}
- 성격: {char_a_personality}
[캐릭터 B 프로필 ({char_b_name})]
- 설명: {char_b_description}
- 목표: {char_b_goals}
- 성격: {char_b_personality}
---
**출력 JSON 스키마:**
{{
  "type": "관계 유형 (예: 숙명의 라이벌)",
  "description": "관계에 대한 구체적인 설명 (2~3 문장)."
}}
"""

    plot_point_edit: str = """당신은 이야기의 전체적인 일관성을 유지하며 특정 부분을 섬세하게 수정하는 전문 스토리 편집자입니다.
아래 제공된 '전체 스토리 흐름'과 컨텍스트를 참고하여, '수정 대상 플롯 포인트'를 사용자의 '수정 요청사항'에 맞게 수정해주세요.

{story_concept}
{prologue_context}
[주요 등장인물]
{characters_context}

[전체 스토리 흐름]
{full_story_context}
---
[수정 대상 플롯 포인트]
- 제목: {plot_title}
- 내용: {plot_content}

[사용자 수정 요청사항]
"{user_prompt}"
---
**매우 중요한 규칙:**
1.  **오직 '수정 대상 플롯 포인트'의 제목과 내용만** 수정해야 합니다.
2.  수정된 내용은 '전체 스토리 흐름'의 맥락과 자연스럽게 연결되어야 합니다.
3.  결과는 반드시 아래 명시된 JSON 스키마 형식으로만 응답해야 합니다.
4.  **만약 어떤 이유로든 수정에 실패할 경우, 오류 메시지 대신 원본 제목과 내용을 담은 유효한 JSON을 반환해야 합니다.** 이 규칙은 절대적입니다.

**출력 JSON 스키마:**
```json
{{
  "title": "새롭게 수정된 플롯 제목",
  "content": "새롭게 수정된 플롯 내용 (2~3 문장)"
}}
```
"""

    plot_points_edit: str = """[SYSTEM INSTRUCTION]
당신은 이야기의 전체적인 흐름과 일관성을 꿰뚫어 보는 전문 스토리 편집자입니다.
주어진 [CONTEXT]와 [EXISTING PLOT POINTS]를 바탕으로, 사용자의 [USER REQUEST]를 반영하여 전체 플롯을 수정해야 합니다.

[CONTEXT]
{worldview_rules_context}
{story_genre_context}
{scenario_themes}
{characters_context}
{story_concept}
{prologue_context}
---

[EXISTING PLOT POINTS]
{plot_points_context}
---

[USER REQUEST]
"{user_prompt}"
---

[TASK]
1.  [USER REQUEST]를 깊이 이해하고, [EXISTING PLOT POINTS]의 전체적인 흐름을 어떻게 수정해야 할지 파악하세요.
2.  요청에 따라 일부 플롯 포인트의 `title`과 `content`를 수정하거나, 여러 플롯 포인트를 통합/재구성하여 새로운 내용으로 변경하세요.
3.  **매우 중요한 규칙: 전체 플롯 포인트의 총 개수는 절대 변경해서는 안 됩니다.** 기존 플롯이 {plot_point_count}개였다면, 수정된 결과도 반드시 {plot_point_count}개의 플롯 포인트여야 합니다.
4.  수정된 내용은 [CONTEXT]의 설정과 충돌해서는 안 되며, 이야기의 일관성을 유지해야 합니다.
5.  최종 결과물은 반드시 아래 JSON 스키마를 따르는 단 하나의 JSON 객체여야 합니다. 다른 설명은 절대 포함하지 마세요.

**JSON 스키마:**
{{
  "plot_points": [
    {{
      "title": "수정된 플롯 포인트의 간결한 제목",
      "content": "수정된 플롯 포인트의 상세한 설명."
    }}
  ]
}}

---
[CRITICAL FINAL INSTRUCTION]
Your entire response must start with `{{` and end with `}}`. No other text, explanation, or formatting is permitted.
"""

    # [수정] 장면 생성 프롬프트: surrounding_context를 사용하도록 변경
    scene_generation_novel: str = """당신은 독자의 감각을 자극하고 마음을 움직이는 묘사에 능한 베테랑 소설가입니다.
주어진 상황과 설정을 바탕으로, 독자가 마치 그 장면 속에 직접 들어가 있는 듯한 몰입감을 선사하는 한 편의 장면을 소설 형식으로 서술해주세요.

**[장면의 역할과 목표]**
- 이 장면은 이야기의 **{plot_position_context}**에 해당합니다.
- **연출 지침:** {plot_pacing_instruction}
- **분량 조절:** {word_count_instruction}

**[스토리 흐름]**
{surrounding_context}
- **이번 장면의 핵심 목표:** {plot_title} - {plot_content}

**[활용 가능한 배우 목록 (등장인물)]**
{characters_context}{relationships_context}

**[창작 가이드라인]**
1.  **핵심 인물 집중:** 이 장면의 목표 달성을 위해 **가장 중요한 인물에 집중**하세요. 제공된 모든 인물을 등장시킬 필요는 전혀 없습니다.
2.  **감정선 중심 서술:** 인물의 행동뿐만 아니라, 그 행동을 하는 순간의 내면 심리, 감정 변화를 섬세하게 묘사해주세요.
3.  **생생한 묘사:** 시각, 청각, 후각 등 오감을 자극하는 표현으로 장면의 분위기를 구체적으로 그려주세요.
4.  **(중요) 흐름의 연결:** '주변 플롯 정보'가 제공되었다면, 현재 장면이 그 흐름과 자연스럽게 이어지도록 서술해주세요.

다른 부가적인 설명 없이, 오직 완성된 소설 본문만 작성해주세요.
---
[결과물]
"""

    # [수정] 장면 생성 프롬프트: surrounding_context를 사용하도록 변경
    scene_generation_screenplay: str = """당신은 장면을 시각적으로 구성하고 배우의 연기를 이끌어내는 전문 시나리오 작가입니다.
주어진 상황과 설정을 바탕으로, 표준 시나리오 형식(장면 제목, 지문, 대사)에 맞춰 한 편의 장면을 작성해주세요.

**[장면의 역할과 목표]**
- 이 장면은 이야기의 **{plot_position_context}**에 해당합니다.
- **연출 지침:** {plot_pacing_instruction}
- **분량 조절:** {word_count_instruction}

**[스토리 흐름]**
{surrounding_context}
- **이번 장면의 핵심 목표:** {plot_title} - {plot_content}

**[활용 가능한 배우 목록 (등장인물)]**
{characters_context}{relationships_context}

**[창작 가이드라인]**
1.  **핵심 인물 집중:** 이 장면의 목표 달성을 위해 **가장 중요한 인물에 집중**하세요. 제공된 모든 인물을 등장시킬 필요는 전혀 없습니다.
2.  **'보여주기(Showing)':** 감정이나 상황을 설명하지 말고, 인물의 행동, 표정, 대사를 통해 간접적으로 보여주세요.
3.  **구체적인 지문:** 카메라가 무엇을 비춰야 할지, 배우가 어떤 톤으로 말해야 할지가 눈에 보이도록 구체적으로 작성해야 합니다.
4.  **(중요) 흐름의 연결:** '주변 플롯 정보'가 제공되었다면, 현재 장면이 그 흐름과 자연스럽게 이어지도록 서술해주세요.

다른 부가적인 설명 없이, 오직 완성된 시나리오 본문만 작성해주세요.
---
[결과물 (예시 형식 준수)]
SCENE START

장소. [장소 이름] - [낮/밤]

[등장인물의 행동, 표정, 배경 등에 대한 상세한 묘사(지문)]

[캐릭터 이름]
([대사의 톤이나 지시사항])
[대사 내용]

SCENE END
"""

    # [수정] 장면 생성 프롬프트: surrounding_context를 사용하도록 변경
    scene_generation_game_dialogue: str = """당신은 플레이어의 몰입을 극대화하는 게임 시나리오 작가입니다.
주어진 상황과 설정을 바탕으로, 캐릭터의 성격이 명확히 드러나는 게임 대사 지문을 작성해주세요.

**[장면의 역할과 목표]**
- 이 장면은 이야기의 **{plot_position_context}**에 해당합니다.
- **연출 지침:** {plot_pacing_instruction}
- **분량 조절:** {word_count_instruction}

**[스토리 흐름]**
{surrounding_context}
- **이번 장면의 핵심 목표:** {plot_title} - {plot_content}

**[활용 가능한 배우 목록 (등장인물)]**
{characters_context}{relationships_context}

**[창작 가이드라인]**
1.  **핵심 인물 집중:** 이 장면의 목표 달성을 위해 **가장 중요한 인물에 집중**하세요. 제공된 모든 인물을 등장시킬 필요는 전혀 없습니다.
2.  **성격이 드러나는 대사:** 각 대사는 해당 캐릭터의 성격, 가치관, 말투를 명확히 반영해야 합니다.
3.  **간결하고 명확하게:** 플레이어가 쉽게 이해하고 따라갈 수 있도록 간결한 문장을 사용해주세요.
4.  **(중요) 흐름의 연결:** '주변 플롯 정보'가 제공되었다면, 현재 장면이 그 흐름과 자연스럽게 이어지도록 서술해주세요.

다른 부가적인 설명 없이, 오직 완성된 게임 대사 지문만 작성해주세요.
---
[결과물 (예시 형식 준수)]
[장면이 시작될 때 플레이어에게 보여줄 간단한 상황 묘사. 예: 낡은 선술집 안, 모닥불이 타오르고 있다.]

[캐릭터 이름]: "[대사 내용]"
[다른 캐릭터 이름]: "[대사 내용]"
[시스템]: [선택지나 특별한 이벤트 발생 시 괄호 안에 서술. 예: (갑자기 문이 열리며 낯선 이가 들어선다.)]
"""

    # [수정] 장면 수정 프롬프트: surrounding_context를 사용하도록 변경
    scene_edit: str = """당신은 기존 장면을 기반으로 작가의 요청에 맞게 세밀하게 수정하는 전문 편집자입니다.
기존 장면의 핵심 구조와 맥락을 유지하면서, 사용자의 요청사항을 자연스럽게 반영해주세요.

**[이 장면의 역할과 배경]**
- 이 장면은 이야기의 **{plot_position_context}**에 해당합니다.
- **장면의 핵심 목표:** {plot_title} - {plot_content}
- **출력 형식:** {output_format}
- **분량 조절:** {word_count_instruction}

**[스토리 흐름]**
{surrounding_context}
**[기존 장면 내용 (수정 대상)]**
{existing_scene_draft}

**[활용 가능한 등장인물]**
{characters_context}{relationships_context}

**[사용자 수정 요청사항]**
{user_edit_request}

**[수정 가이드라인]**
1. **기존 장면의 핵심 구조 유지**: 전체적인 흐름과 중요한 사건은 그대로 두되, 요청사항에 맞게 표현이나 묘사를 조정해주세요.
2. **자연스러운 통합**: 수정사항이 기존 내용과 어색하지 않게 자연스럽게 어우러지도록 해주세요.
3. **일관성 유지**: 등장인물의 성격이나 세계관 설정과 일치하도록 수정해주세요.
4. **요청 중심 개선**: 사용자가 요청한 부분에 집중하여 수정하되, 불필요한 변경은 피해주세요.
5. **(중요) 흐름의 연결:** '주변 플롯 정보'가 있다면, 수정된 장면이 그 흐름과 자연스럽게 이어지도록 각별히 신경 써주세요.

다른 부가적인 설명 없이, 오직 수정된 장면 본문만 작성해주세요.
---
[수정된 결과물]
"""


# 설정 인스턴스 생성
ai_models = AIModels()
ai_prompts = AIPrompts()
