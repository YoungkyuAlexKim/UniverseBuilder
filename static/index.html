<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scenario Universe Builder</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <link rel="stylesheet" href="/static/css/main.css?v=1.4"> 
    
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/diff_match_patch/20121119/diff_match_patch.js"></script>
    
    <!-- [신규] Vis.js 네트워크 라이브러리 추가 -->
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    
    <script type="module" src="/static/js/main.js?v=1.5"></script>
</head>
<body>
    <div class="grid-container">
        <aside class="sidebar">
            <div class="project-list-container">
                <hgroup><h3>🗂️ 프로젝트</h3></hgroup>
                <ul class="project-list"><li aria-busy="true">프로젝트 로딩 중...</li></ul>
            </div>
            <div>
                <form id="create-project-form">
                    <input type="text" name="name" placeholder="새 프로젝트 이름..." required autocomplete="off">
                    <button type="submit">프로젝트 추가</button>
                </form>
                <hgroup><h3>✨ AI 모델</h3></hgroup>
                <form>
                    <label for="ai-model-select">사용할 모델 선택</label>
                    <select id="ai-model-select">
                        <option value="gemini-2.5-flash-lite">Gemini-2.5 Flash Lite (빠름)</option>
                        <option value="gemini-2.5-flash">Gemini-2.5 Flash (보통)</option>
                        <option value="gemini-2.5-pro">Gemini-2.5 Pro (고품질)</option>
                    </select>
                </form>
            </div>
        </aside>

        <div class="resizer" id="resizer"></div>

        <main class="main-content">
            <div id="welcome-view" class="content-view active">
                <hgroup><h1>시나리오 유니버스 빌더</h1><h2>좌측 메뉴에서 작업을 선택해주세요.</h2></hgroup>
                <p>이곳에 선택된 메뉴의 UI가 나타납니다.</p>
            </div>
            
            <div id="project-detail-view" class="content-view">
                <hgroup><h1 id="project-title-display"></h1></hgroup>
                <nav>
                    <ul>
                        <li><a href="#" class="tab-link active" data-tab="characters">캐릭터</a></li>
                        <li><a href="#" class="tab-link" data-tab="worldview">세계관</a></li>
                    </ul>
                </nav>
                <div id="tab-content-characters" class="tab-content active">
                    <div id="card-list-container"></div> 
                </div>
                <div id="tab-content-worldview" class="tab-content">
                    <article>
                        <hgroup>
                            <h4>메인 세계관</h4>
                            <p>프로젝트의 가장 핵심적인 배경 설정입니다. AI 캐릭터 생성 시 기본 정보로 활용됩니다.</p>
                        </hgroup>
                        <form id="worldview-form">
                            <textarea id="worldview-content" rows="10" placeholder="이곳에 프로젝트의 핵심 세계관 설정을 입력하거나 AI로 생성할 수 있습니다..."></textarea>
                            
                            <div class="worldview-button-bar">
                                <div>
                                    <button type="button" id="ai-generate-new-btn" class="secondary">새로 생성하기 (AI)</button>
                                    <button type="button" id="ai-work-on-existing-btn" class="secondary">기존 내용으로 작업 (AI)</button>
                                </div>
                                <button type="submit" id="save-worldview-btn">메인 세계관 저장</button>
                            </div>
                        </form>
                    </article>
                    <hr>
                    <div id="worldview-card-list-container">
                        </div>
                </div>
            </div>
        </main>
    </div>

    <div id="modal-backdrop"></div>

    <div id="card-details-modal" class="modal-container">
        <article>
            <header>
                <a href="#close" aria-label="Close" class="close"></a>
                <h3 id="modal-card-name"></h3>
            </header>
            <div id="modal-card-content">
            </div>
            <footer class="grid" id="modal-card-footer">
            </footer>
        </article>
    </div>
    
    <div id="worldview-card-modal" class="modal-container">
        <article>
            <header>
                <a href="#close" aria-label="Close" class="close"></a>
                <h3 id="worldview-modal-title">세계관 설정 카드</h3>
            </header>
            <form id="worldview-card-form">
                <input type="text" id="worldview-modal-card-title" name="title" placeholder="설정 제목 (예: 마법의 원리)" required>
                <textarea id="worldview-modal-card-content" name="content" rows="12" placeholder="세부 내용을 입력하세요..."></textarea>
                <button type="submit" id="worldview-modal-save-btn">저장</button>
            </form>
        </article>
    </div>
    
    <div id="ai-diff-modal" class="modal-container">
        <article style="max-width: 90vw; width: 1200px;">
            <header>
                <a href="#close" aria-label="Close" class="close"></a>
                <h3>AI 수정 제안 검토</h3>
            </header>
            <div id="ai-diff-container" class="grid">
                <article>
                    <header><strong>원본 내용</strong></header>
                    <div id="ai-diff-original"></div>
                </article>
                <article>
                    <header><strong>AI 수정 제안</strong></header>
                    <div id="ai-diff-suggestion"></div>
                </article>
            </div>
            <footer>
                <div class="grid" style="justify-content: flex-end;">
                    <button id="ai-diff-reject-btn" class="secondary outline" style="width: auto;">반려</button>
                    <button id="ai-diff-accept-btn" style="width: auto;">이 내용으로 적용</button>
                </div>
            </footer>
        </article>
    </div>

</body>
</html>